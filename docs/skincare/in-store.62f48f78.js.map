{"version":3,"sources":["../samples/contentstack-integration/secrets.js","js/data_sources.js","scenario1/in-store.js"],"names":["secrets","apiKey","environment","deliveryToken","data_sources","contentstack","personalized","getData","getStackData","$export","document","querySelector","GQL_URL","GQL_HEADERS","gqlQuery","rearrangeAPIResponse","response","newData","data","all_product","items","i","serums","length","entry","parseInt","product_name","split","contraindications","additional_contraindications","push","usage_frequency","usage_frequencyConnection","edges","map","item","node","title","marker_patt_urls","marker_fileConnection","url","product_image_urls","product_imagesConnection","ingredients","ingredient_list","ingredient_edges","ingredientsConnection","n","name","also_known_as","imageConnection","image_url","description","concentration","directions","instructions","text","step_instruction_text","console","log","sort","a","b","_id","productsByGraphQL","window","fetch","method","headers","body","JSON","stringify","query","then","json","other_product_images","cleanser","toner","moisturizer_empty","moisturizers","sunscreen","why","for_you","ratings","approval","friends_who_like","reviews","user","testimonial","ready","fn","readyState","addEventListener","$statusLabel","$scanner","$scanLine","$main","$tray","$backButton","$addButton","$serumMarkers","querySelectorAll","currentProduct","$contentFan_1","getElementById","$tabMenu_1","$tabMenu_2","$contentFan_2","$tabMenu_3","$contentFan_3","pause","millis","endTime","Date","getTime","Promise","resolve","ticktock","requestAnimationFrame","pauseUntilEnd","eventType","el","propertyOrAnimationName","endEvent","endFunction","e","animationName","propertyName","removeEventListener","productRecognized","productID","innerHTML","classList","add","textContent","remove","productOutOfView","backToExplore","stopPropagation","preventDefault","addToRoutine","tagToProduct","target","forEach","$marker","id","checkType","reviewType","ingredientsType","scenarioData","generateContentFanData","csProduct","localProduct","productData","warnings","j","type","toUpperCase","icon","makePanel","panel","createElement","setAttribute","content","components","initializeFromData","setTimeout","initializeScenario1","contentFan_1","contentfan","contentFan_2","contentFan_3","buildWithContentElements","handleTouchStart","handleTouchMove","handleSwipeLeft","incrementSelectedIndex","incrementContentIndex","handleSwipeRight","decrementSelectedIndex","decrementContentIndex","xDown","yDown","getTouches","evt","touches","firstTouch","clientX","clientY","xUp","yUp","xDiff","yDiff","Math","abs"],"mappings":"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","file":"in-store.62f48f78.js","sourceRoot":"../../src","sourcesContent":["const secrets = {\n  apiKey: 'blte63f7056be4da683',\n  environment: 'localhost-dev',\n  deliveryToken: 'cs01d945711b0bb626d33ad776',\n}\nexport default secrets;","import secrets from '../../samples/contentstack-integration/secrets';\n\nconst data_sources = {\n  contentstack: {},\n  personalized: {},\n  getData: () => 0\n}\n\nasync function getStackData() {\n  const $export = document.querySelector('#cleaned_output');\n\n  const GQL_URL = `https://graphql.contentstack.com/stacks/${secrets.apiKey}?environment=${secrets.environment}`\n  const GQL_HEADERS = {\n    'Content-Type': 'application/json',\n    'access_token': secrets.deliveryToken,\n  };\n  const gqlQuery = `{\n    all_product(where: {product_line: \"Serums\"}) {\n      items {\n        title\n        product_name\n        brand\n        product_line\n        upc\n        form\n        amount {\n          quantity\n          measurement\n        }\n        packaging {\n          type\n        }\n        rating\n        additional_contraindications\n        usage_frequencyConnection(limit:7) {\n          edges {\n            node {\n              ... on UsageTimeTags {\n                title\n              }\n            }\n          }\n        }\n        marker_fileConnection(limit: 3) {\n          edges {\n            node {\n              title\n              url\n            }\n          }\n        }\n        product_imagesConnection(limit: 1) {\n          edges {\n            node {\n              title\n              url\n            }\n          }\n        }\n        instructions {\n          step_instruction_text\n        }\n        ingredient_list {\n          concentration\n          ingredientsConnection {\n            edges {\n              node {\n                ... on Ingredient {\n                  title\n                  name\n                  also_known_as\n                  description\n                  imageConnection {\n                    edges {\n                      node {\n                        title\n                        url\n                      }\n                    }\n                  }\n                  contraindications\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }`;\n  function rearrangeAPIResponse(response) {\n    let newData = {};\n    if (response?.data?.all_product) {\n      newData = {'serums': [...response.data.all_product.items]};\n      for (let i = 0; i < newData.serums.length; i++) {\n          const entry = {\n          // Add an id (What serum no. is it?)\n          '_id': parseInt(newData.serums[i].product_name.split(' ')[2]),\n          ...newData.serums[i]\n        }\n        // Remove nesting of references\n        // ✔️ contraindications (see ingredients below)\n        entry.contraindications = []; \n        if (entry.additional_contraindications?.length) {\n          entry.contraindications.push(entry.additional_contraindications);\n        }\n        delete(entry.additional_contraindications);\n        // ✔️ usage frequency\n        entry.usage_frequency = entry.usage_frequencyConnection.edges.map((item) => item.node.title);\n        delete(entry.usage_frequencyConnection);\n        // ✔️ marker pattern\n        entry.marker_patt_urls = entry.marker_fileConnection.edges.map((item) => item.node.url);\n        delete(entry.marker_fileConnection);\n        // ✔️ product image\n        entry.product_image_urls = entry.product_imagesConnection.edges.map((item) => item.node.url);\n        delete(entry.product_imagesConnection);\n        // ✔️ ingredients\n        entry.ingredients = entry.ingredient_list.map((item) => {\n          const ingredient_edges = item.ingredientsConnection.edges;\n          if (ingredient_edges.length) {\n            // There will only be one ingredient in the ingredientsConnection\n            const n = {};\n            n.name = ingredient_edges[0].node.name;\n            n.also_known_as = ingredient_edges[0].node.also_known_as;\n            if ('edges' in ingredient_edges[0].node.imageConnection && \n                ingredient_edges[0].node.imageConnection.edges.length) {\n              n.image_url = ingredient_edges[0].node.imageConnection.edges[0].node.url;\n            }\n            n.description = ingredient_edges[0].node.description;\n            if (item.concentration) n.concentration = item.concentration;\n            // Add the contraindications \n            if (ingredient_edges[0].node.contraindications) {\n              entry.contraindications.push(ingredient_edges[0].node.contraindications);\n            }\n            return n;\n          } \n        });\n        delete(entry.ingredient_list);\n        // simplify usage instructions\n        entry.directions = entry.instructions.map((item) => {return {text: item.step_instruction_text}});\n        delete(entry.instructions);\n        newData.serums[i] = entry;\n      }\n    }\n    console.log(newData);\n    // Sort the serums\n    newData.serums.sort((a,b) => a._id - b._id);\n    return newData;\n  }\n\n  // Guidance here: https://graphql.org/learn/serving-over-http/#http-methods-headers-and-body\n  const productsByGraphQL = await window.fetch(\n    GQL_URL,\n    {\n      method: 'POST', \n      headers: GQL_HEADERS,\n      body: JSON.stringify({query: gqlQuery})\n    }\n    )\n  .then(response => response.json())\n  .then(data => rearrangeAPIResponse(data));\n\n  data_sources.contentstack = productsByGraphQL;\n}\n\n// This data would be stored in another database.\ndata_sources.personalized = {\n  other_product_images: {\n    cleanser: 'https://images.contentstack.io/v3/assets/blte63f7056be4da683/blt2768458962874adb/5f5d73c7ace172423d8845be/01_Cleanser_3.png',\n    toner: 'https://images.contentstack.io/v3/assets/blte63f7056be4da683/blt3b2f9c68cda139c8/5f5d73b82917074cd81a2925/02_Toner_3.png',\n    moisturizer_empty: 'https://images.contentstack.io/v3/assets/blte63f7056be4da683/blt879660a27aedbfec/5f5d73a665c9c14aec2fb9f7/04_Moisturizer_0.png',\n    moisturizers: [\n      'https://images.contentstack.io/v3/assets/blte63f7056be4da683/blta69fd32048fdecab/5f5d740674038f4956e098d8/04_Moisturizer_1.png',\n      'https://images.contentstack.io/v3/assets/blte63f7056be4da683/blt7e0ba1616f10fbd1/5f5d85e42917074cd81a2929/04_Moisturizer_7.png'\n    ],\n    sunscreen: 'https://images.contentstack.io/v3/assets/blte63f7056be4da683/blt80ab90086435bebe/5f5d739883eade441b6a6ae8/05_Sunscreen_0.png'\n  },\n  serums: [\n    {\n      _id: 1,\n      why: [\n        'Your goal is anti-aging.',\n        'Better than leading competitors\\' products.',\n        'Cheaper than leading competitors\\' products.',\n        'Sweet floral fragrance!'\n      ],\n      for_you: [\n        {\n          title: 'Conserve and save',\n          text: 'You\\'ve used Serum for 3 weeks with smoother skin? Consider increasing your concentration from 2% to 5% to increase cell turnover at an even faster rate.'\n        },\n        {\n          title: 'Shields up',\n          text: 'The UV index is super high today in your area! Make sure to apply sunscreen throughout the day after using this serum.'\n        }  \n      ],\n      ratings: {\n        approval: 86,\n        friends_who_like: 6,\n        reviews: [\n          {\n            user: 'yourfriendjen',\n            title: 'THE BEST SERUM OUT THERE',\n            testimonial: '\"This made such a huge difference with my combination-dry skin. My pore seem smaller, my skin brighter, and my complexion more even.\"'\n          }\n        ]\n      }\n    },\n    {\n      _id: 2,\n      why: [\n        'Your goal is moisturizing.',\n        'Better than leading competitors\\' products.',\n        'Borage seed is a natural mellowing agent.',\n        'No allergens for you!'\n      ],\n      for_you: [\n        {\n          title: 'Feeling drier?',\n          text: 'Humidity forecasts are down for your location. Use a water-based solution to hydrate skin, then apply drops as needed.'\n        },\n        {\n          title: 'Relax naturally',\n          text: 'If you’re feeling a bit stressed out, know that Borage Seed Oil also creates a natural calming effect.'\n        }  \n      ],\n      ratings: {\n        approval: 47,\n        friends_who_like: 2,\n        reviews: [\n          {\n            user: 'yourfriendjen',\n            title: 'THE BEST SERUM OUT THERE',\n            testimonial: '\"This made such a huge difference with my combination-dry skin. My pore seem smaller, my skin brighter, and my complexion more even.\"'\n          }\n        ]\n      }\n    },\n    {\n      _id: 3,\n      why: [\n        'Your goal is smoother skin.',\n        'Better than leading competitors\\' products.',\n        'Cheaper than leading competitors\\' products.',\n        'No allergens for you!'\n      ],\n      for_you: [\n        {\n          title: 'Next level',\n          text: 'Need more moisturizer? See our site to learn how to add our face oils into your routine to better hydrate your skin…'\n        },\n        {\n          title: 'Shields up',\n          text: 'The UV index is super high today in your area! Make sure to apply sunscreen throughout the day after using this serum.'\n        }  \n      ],\n      ratings: {\n        approval: 86,\n        friends_who_like: 6,\n        reviews: [\n          {\n            user: 'yourfriendjen',\n            title: 'THE BEST SERUM OUT THERE',\n            testimonial: '\"This made such a huge difference with my combination-dry skin. My pore seem smaller, my skin brighter, and my complexion more even.\"'\n          }\n        ]\n      }\n    }\n  ],\n\n}\n\ndata_sources.getData = getStackData;\n// console.log('inside data_sources.js and ',data_sources);\n\nexport default data_sources;","import data_sources from '../js/data_sources';\n\nfunction ready(fn) {\n  // replaces $(document).ready() in jQuery\n  if (document.readyState != 'loading'){\n      fn();\n  } else {\n      document.addEventListener('DOMContentLoaded', fn);\n  }\n}\n\nready(async () => {\n  console.log('DOM is ready.');\n  // Wait for the Contentstack data to come back before proceeding!\n  await data_sources.getData();\n  console.log(data_sources);\n  const $statusLabel = document.querySelector('#status_label');\n  const $scanner = document.querySelector('#scanner');\n  const $scanLine = document.querySelector('#scanner svg line');\n  const $main = document.querySelector('main');\n  const $tray = document.querySelector('#tray');\n  const $backButton = document.querySelector('a.back');\n  const $addButton = document.querySelector('a.add');\n  const $serumMarkers = document.querySelectorAll('a-marker');\n  let currentProduct = 0;\n\n\n  // TODO: Jason please fix my selectors to be smarter T_T\n\n  let $contentFan_1 = document.getElementById(\"contentFan_serum1\");\n  let $tabMenu_1 = document.getElementById('tab-menu-1');\n\n  let $tabMenu_2 = document.getElementById('tab-menu-2');\n  let $contentFan_2 = document.getElementById(\"contentFan_serum2\");\n\n  let $tabMenu_3 = document.getElementById('tab-menu-3');\n  let $contentFan_3 = document.getElementById(\"contentFan_serum3\");\n\n  /** Two useful functions:\n    * - pause(X) \n    *    returns a promise that resolves after X milliseconds.\n    * \n    * - pauseUntilEnd('transition', $el, 'property_name') ~or~\n    *   pauseUntilEnd('animation', $el, 'anim_name')\n    *    (where property_name and anim_name are optional)\n    *    returns a promise that resolves when an animation or \n    *    transition finishes.\n    * \n    * Put them inside an async function and use like so:\n    *   await pause(750)\n    * ...and it will wait before moving on.\n    */\n  async function pause(millis) {\n    const endTime = new Date(new Date().getTime() + millis);\n    return new Promise((resolve) => {\n      function ticktock() {\n        if (new Date() >= endTime) {\n          resolve(true);\n        } else {\n          requestAnimationFrame(ticktock);\n        }\n      }\n      ticktock();\n    })\n  }\n  async function pauseUntilEnd(eventType, el, propertyOrAnimationName) {\n    let endEvent = 'transitionend';\n    switch (eventType) {\n      case 'animation':\n      case 'a':\n        endEvent = 'animationend';\n        break;\n      case 'transition':\n      case 't':\n      default:\n        endEvent = 'transitionend';\n        break;\n    }\n    return new Promise((resolve) => {\n      const endFunction = (e) => {\n        // If specifying the property name on a transition / the animation name on animation...\n        if (propertyOrAnimationName) {\n          // ...ignore all events that aren't the end of this particular animation/transition.\n          if (endEvent === 'animationend' && e.animationName !== propertyOrAnimationName) return;\n          if (endEvent === 'transitionend' && e.propertyName !== propertyOrAnimationName) return;\n        }\n        // Clean up after.\n        el.removeEventListener(endEvent, endFunction);\n        resolve(true);\n      }\n      el.addEventListener(endEvent, endFunction);\n    });\n  }\n  \n  async function productRecognized(productID) {\n    // TODO: recognize which product it is and cue up the data in A-Frame here\n    currentProduct = productID;\n\n    // Kick off the animation to scan.\n    $statusLabel.innerHTML = 'Scanning...';\n    $scanner.classList.add('scanning');\n    await pauseUntilEnd('a', $scanLine, 'blip');\n    $statusLabel.textContent = 'Found!';\n    $scanner.classList.add('complete');\n    $main.classList.add('serum'+productID);\n    await pause(750);\n    $main.classList.add('found');\n    $main.classList.remove('serum'+productID);\n    $scanner.classList.remove('scanning');\n    $scanner.classList.remove('complete');\n  }\n\n  function productOutOfView(e) {\n    currentProduct = 0;\n\n    // Remove all classes from scanner\n    $scanner.classList.remove('scanning');\n    $scanner.classList.remove('complete');\n    // Reset the label\n    $statusLabel.innerHTML = 'Explore Serums';\n  }\n  function backToExplore(e) {\n    // Prevent link from going anywhere\n    e.stopPropagation();\n    e.preventDefault();\n    // reset the currentProduct\n    currentProduct = 0;\n    // Reset the label\n    $statusLabel.innerHTML = 'Explore Serums';\n    $scanner.classList.remove('scanning');\n    $scanner.classList.remove('complete');\n    $main.classList.remove('found');\n    $main.classList.remove('serum1');\n    $main.classList.remove('serum2');\n    $main.classList.remove('serum3');\n    // ...which will slide up the tray.\n    // Prevent changing the URL?\n    return false;\n  }\n\n  async function addToRoutine(e) {\n    // Prevent link from going anywhere\n    e.stopPropagation();\n    e.preventDefault();\n\n    currentProduct = 0;\n\n    $statusLabel.textContent = 'Explore Serums';\n    $scanner.classList.remove('scanning');\n    $scanner.classList.remove('complete');\n    $main.classList.remove('found');\n    await pauseUntilEnd('transition', $tray, 'bottom');\n\n    $statusLabel.textContent = 'Explore Moisturizers';\n    $tray.classList.remove('step-3');\n    $tray.classList.add('step-4');\n    await pause(1000);\n\n    console.log('moving to scenario 2');\n    // TODO: Add listener when click on going-home interstitial\n    $main.classList.add('going-home');\n    // Prevent changing the URL?\n    return false;\n  }\n\n  function tagToProduct(target) {\n    switch(target) {\n      case \"serum_1_marker\":\n        return 1;\n      case \"serum_2_marker\":\n        return 2;\n      case \"serum_3_marker\":\n        return 3;\n      default:\n      return null;\n    }\n  }\n\n\n  $serumMarkers.forEach(function($marker) {\n\n    $marker.addEventListener(\"markerFound\", (e)=>{ // your code here}\n      let target = e.target;\n      let productID = tagToProduct(target.id);\n\n      if (productID) {\n        console.log(\"Detected product \", productID);\n\n        // call productRecognized\n        productRecognized(productID);\n      }\n    })\n\n    $marker.addEventListener(\"markerLost\", (e)=>{ // your code here}\n      let target = e.target;\n      let productID = tagToProduct(target.id);\n\n      if (productID) {\n        console.log(\"Lost product \", productID);\n\n        // Call productOutOfView\n        productOutOfView(productID);\n      }\n    })\n  });\n\n  // Create data for scenario 1 for all three serums\n  const checkType = \"numbered-text\";\n  const reviewType = \"numbered-text\";\n  const ingredientsType = \"textwithicon\";\n  let scenarioData = [];\n  \n  function generateContentFanData() {\n    for (let i = 0; i < data_sources.contentstack.serums.length; i++) {\n      const csProduct = data_sources.contentstack.serums[i];\n      const localProduct = data_sources.personalized.serums[i];\n      const productData = {\n        why: [],\n        reviews: [],\n        warnings: []\n      }\n      for (let j = 0; j < localProduct.why.length; j++) {\n        productData.why.push({\n          title: ''+(j+1),\n          body: localProduct.why[j],\n          type: checkType\n        })\n      }\n      for (let j = 0; j < localProduct.ratings.reviews.length; j++) {\n        productData.reviews.push({\n          title: localProduct.ratings.reviews[j].title.toUpperCase(),\n          body: '\\n' + localProduct.ratings.reviews[j].testimonial,\n          type: reviewType\n        });\n      }\n      for (let j=0; j < csProduct.contraindications.length; j++) {\n        productData.warnings.push({\n          icon: '#warning',\n          title: 'CONTRAINDICATIONS',\n          body: csProduct.contraindications[j],\n          type: ingredientsType\n        });\n      }\n      scenarioData.push(productData);\n    }\n  }\n  generateContentFanData();\n\n  let makePanel = function(data) {\n    // Build content panels with \"data\"\n    var panel = document.createElement('a-entity');\n    panel.setAttribute(\"content-group\", \"\");\n\n    let content = panel.components['content-group'];\n    content.initializeFromData(data);\n\n    return panel\n  }\n\n  setTimeout(initializeScenario1, 1000);\n\n  function initializeScenario1() {\n\n    // Build content panels with \"data\"\n    let contentFan_1 = $contentFan_1.components.contentfan\n    let contentFan_2 = $contentFan_2.components.contentfan\n    let contentFan_3 = $contentFan_3.components.contentfan\n\n    // Add content to content fan\n    // At some point we can find a better way to sync this w/the tab menu\n    contentFan_1.buildWithContentElements([makePanel(scenarioData[0].warnings), makePanel(scenarioData[0].why), makePanel(scenarioData[0].reviews)]);\n    contentFan_2.buildWithContentElements([makePanel(scenarioData[1].warnings), makePanel(scenarioData[1].why), makePanel(scenarioData[1].reviews)]);\n    contentFan_3.buildWithContentElements([makePanel(scenarioData[2].warnings), makePanel(scenarioData[2].why), makePanel(scenarioData[2].reviews)]);\n\n    // Add listeners for buttons\n    $backButton.addEventListener('click', backToExplore);\n    $addButton.addEventListener('click', addToRoutine);\n    // This is temporary, until we have onmarkerfound event...\n    // $tray.addEventListener('click', productRecognized);\n\n    // Swipe detection\n    document.addEventListener('touchstart', handleTouchStart, false);\n    document.addEventListener('touchmove', handleTouchMove, false);\n\n    // document.addEventListener('swipeleft', handleSwipeLeft, false);\n    // document.addEventListener('swiperight', handleSwipeRight, false);\n\n    function handleSwipeLeft() {\n      // We are just broadcasting swipes to everyone...not ideal!\n      $tabMenu_1.components[\"tab-menu\"].incrementSelectedIndex()\n      $tabMenu_2.components[\"tab-menu\"].incrementSelectedIndex()\n      $tabMenu_3.components[\"tab-menu\"].incrementSelectedIndex()\n\n      $contentFan_1.components.contentfan.incrementContentIndex()\n      $contentFan_2.components.contentfan.incrementContentIndex()\n      $contentFan_3.components.contentfan.incrementContentIndex()\n\n      // $tabMenu.components.\n    }\n\n    function handleSwipeRight() {\n      console.log(\"swipe right!\")\n      // We are just broadcasting swipes to everyone...not ideal!\n      $tabMenu_1.components[\"tab-menu\"].decrementSelectedIndex()\n      $tabMenu_2.components[\"tab-menu\"].decrementSelectedIndex()\n      $tabMenu_3.components[\"tab-menu\"].decrementSelectedIndex()\n\n      $contentFan_1.components.contentfan.decrementContentIndex()\n      $contentFan_2.components.contentfan.decrementContentIndex()\n      $contentFan_3.components.contentfan.decrementContentIndex()\n    }\n\n    // Originally from https://stackoverflow.com/a/23230280\n    var xDown = null;\n    var yDown = null;\n\n    function getTouches(evt) {\n      return evt.touches;\n    }\n\n    function handleTouchStart(evt) {\n      const firstTouch = getTouches(evt)[0];\n      xDown = firstTouch.clientX;\n      yDown = firstTouch.clientY;\n    };\n\n    function handleTouchMove(evt) {\n      if (!xDown || !yDown) {\n        return;\n      }\n\n      var xUp = evt.touches[0].clientX;\n      var yUp = evt.touches[0].clientY;\n\n      var xDiff = xDown - xUp;\n      var yDiff = yDown - yUp;\n\n      if (Math.abs(xDiff) > Math.abs(yDiff)) {/*most significant*/\n        if (xDiff > 0) {\n          /* left swipe */\n          handleSwipeLeft()\n        } else {\n          handleSwipeRight()\n          /* right swipe */\n        }\n      } else {\n        if (yDiff > 0) {\n          /* up swipe */\n        } else {\n          /* down swipe */\n        }\n      }\n      /* reset values */\n      xDown = null;\n      yDown = null;\n    };\n  }\n})"]}